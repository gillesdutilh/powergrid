<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Find requirements for target power (or other objective) — FindTarget • powergrid</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find requirements for target power (or other objective) — FindTarget"><meta name="description" content="For most use cases of powergrid, you will not need this function, but rather
use more convenient functions, most notable Example. Example
shows you the smallest sample size to still find enough power, or the
largest standard deviation at which your CI95 does not get too large. More
insight about the relation between parameters and the resulting power may be
gained with PowerPlot or GridPlot.
Only if you need to work with, say, the required n for a range of
assumptions over and above PowerPlot and GridPlot, you will need to use
FindTarget.
FindTarget takes as input an array (typically of class power_array).
FindTarget then searches (up or down) along one chosen dimension for a value
that meets a set target value (at least or at most). It does so for each
combination of the remaining dimensions. Concretely, this may mean: The
array contains the calculated power for each combination of dimensions n,
effect size, and SD. The function may then find, for each combination of
effect size and SD, the lowest n for which power of at least, say, .8 is
achieved. The result would be an array of effect size by SD, containing the
n's yielding acceptable power."><meta property="og:description" content="For most use cases of powergrid, you will not need this function, but rather
use more convenient functions, most notable Example. Example
shows you the smallest sample size to still find enough power, or the
largest standard deviation at which your CI95 does not get too large. More
insight about the relation between parameters and the resulting power may be
gained with PowerPlot or GridPlot.
Only if you need to work with, say, the required n for a range of
assumptions over and above PowerPlot and GridPlot, you will need to use
FindTarget.
FindTarget takes as input an array (typically of class power_array).
FindTarget then searches (up or down) along one chosen dimension for a value
that meets a set target value (at least or at most). It does so for each
combination of the remaining dimensions. Concretely, this may mean: The
array contains the calculated power for each combination of dimensions n,
effect size, and SD. The function may then find, for each combination of
effect size and SD, the lowest n for which power of at least, say, .8 is
achieved. The result would be an array of effect size by SD, containing the
n's yielding acceptable power."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">powergrid</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/powergrid.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SwissClinicalTrialOrganisation/powergrid/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Find requirements for target power (or other objective)</h1>
      <small class="dont-index">Source: <a href="https://github.com/SwissClinicalTrialOrganisation/powergrid/blob/main/R/findtarget.R" class="external-link"><code>R/findtarget.R</code></a></small>
      <div class="d-none name"><code>FindTarget.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For most use cases of powergrid, you will not need this function, but rather
use more convenient functions, most notable <code><a href="Example.html">Example</a></code>. <code>Example</code>
shows you the smallest sample size to still find enough power, or the
largest standard deviation at which your CI95 does not get too large. More
insight about the relation between parameters and the resulting power may be
gained with <code><a href="PowerPlot.html">PowerPlot</a></code> or <code><a href="GridPlot.html">GridPlot</a></code>.</p>
<p>Only if you need to work with, say, the required n for a range of
assumptions over and above PowerPlot and GridPlot, you will need to use
FindTarget.</p>
<p>FindTarget takes as input an array (typically of class <code>power_array</code>).
FindTarget then searches (up or down) along one chosen dimension for a value
that meets a set target value (at least or at most). It does so for each
combination of the remaining dimensions. Concretely, this may mean: The
array contains the calculated power for each combination of dimensions n,
effect size, and SD. The function may then find, for each combination of
effect size and SD, the lowest n for which power of at least, say, .8 is
achieved. The result would be an array of effect size by SD, containing the
n's yielding acceptable power.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">FindTarget</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  par_to_search <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  find_lowest <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  target_value <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  target_at_least <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"step"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An array, most commonly of class <code>power_array</code>, possibly the result
of taking a slice of an object of class <code>power_array</code> using
<code><a href="ArraySlicer.html">ArraySlicer</a></code> or the power_array []-indexing method.</p></dd>


<dt id="arg-par-to-search">par_to_search<a class="anchor" aria-label="anchor" href="#arg-par-to-search"></a></dt>
<dd><p>Which parameter should be searched to achieve the
required target value. In the typical power analysis case, this is n.</p></dd>


<dt id="arg-find-lowest">find_lowest<a class="anchor" aria-label="anchor" href="#arg-find-lowest"></a></dt>
<dd><p>If TRUE, the lowest value of par_to_search is found that
yields a value that meets the target. This is typical for n in a sample
size estimation, where one searches the lowest n to achieve a certain
power. For, e.g. the variance, one would however search for the maximum
where the target power can still be achieved.</p></dd>


<dt id="arg-target-value">target_value<a class="anchor" aria-label="anchor" href="#arg-target-value"></a></dt>
<dd><p>The required value in x (e.g., .9, if the values
represent power)</p></dd>


<dt id="arg-target-at-least">target_at_least<a class="anchor" aria-label="anchor" href="#arg-target-at-least"></a></dt>
<dd><p>Is the <code>target_value</code> a minimum (e.g., the power) or
a maximum (e.g., the size of a confidence interval)</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>How is the required <code>par_to_search</code> to achieve
<code>target_value</code> found. Either <code>'step'</code>: walking in steps along
<code>par_to_search</code> or <code>'lm'</code>: Interpolating assuming a linear
relation between <code>par_to_search</code> and <code>(qnorm(x) + qnorm(1 -
  0.05)) ^ 2</code>. Setting 'lm' is inspired on the implementation in the sse
package by Thomas Fabbro.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns an array or vector: containing the value that is found for
the par_to_search (say, n) meeting the target following above criteria
(say, the lowest n for which the power is larger than .9), for each
crossing of the levels of the other dimensions (say, delta, SD).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>By default FindTarget searches along the dimension called <code>n</code>
(<code>par_to_search</code>), searching for the lowest value (<code>find_lowest</code>
= TRUE) where the array contains a value of at least
(<code>target_at_least</code> = TRUE) .9 (the <code>target_value</code>), thus finding the
minimal sample size required to achieve a power of 90%. These arguments
may seem a bit confusing at first, but they allow for three additional
purposes:</p>
<p>First, the implementation also allows to search for a value that is <em>at
most</em> the <code>target_value</code>, by setting <code>target_at_least</code> to FALSE. This may
be used, for example, when the aim is to find a sample size yielding a
confidence interval that is not bigger than some maximum width.</p>
<p>Second, the implementation allows to search along another <em>named</em> dimension
of x than n.</p>
<p>Third, the implementation allows to search for a certain target value to be
achieved by maximizing (find_lowest = FALSE) the parameter on the searched
dimension. This may be used, for example, when the aim is to find the
maximum standard deviation at which a study's power is still acceptable.</p>
<p><code>FindTarget</code> is most often called as the workhorse of
<code><a href="Example.html">Example</a></code>, <code><a href="PowerPlot.html">PowerPlot</a></code> or <code><a href="GridPlot.html">GridPlot</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="PowerGrid.html">PowerGrid</a></code>, <code><a href="Example.html">Example</a></code>,
<code><a href="PowerPlot.html">PowerPlot</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Gilles Dutilh</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## ============================================</span></span></span>
<span class="r-in"><span><span class="co">## A basic power analysis example:</span></span></span>
<span class="r-in"><span><span class="co">## ============================================</span></span></span>
<span class="r-in"><span><span class="va">sse_pars</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">10</span>, to <span class="op">=</span> <span class="fl">60</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sig_level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.01</span>, <span class="fl">.1</span>, <span class="fl">.01</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0.5</span>, to <span class="op">=</span> <span class="fl">1.5</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>, <span class="co">## effect size</span></span></span>
<span class="r-in"><span>  sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.9</span>, <span class="fl">.2</span><span class="op">)</span><span class="op">)</span> <span class="co">## Standard deviation</span></span></span>
<span class="r-in"><span><span class="va">PowFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">sig_level</span>, <span class="va">delta</span>, <span class="va">sd</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">ptt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/power.t.test.html" class="external-link">power.t.test</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span><span class="op">/</span><span class="fl">2</span>, delta <span class="op">=</span> <span class="va">delta</span>, sd <span class="op">=</span> <span class="va">sd</span>,</span></span>
<span class="r-in"><span>                     sig.level <span class="op">=</span> <span class="va">sig_level</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">ptt</span><span class="op">$</span><span class="va">power</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">power_array</span> <span class="op">=</span> <span class="fu"><a href="PowerGrid.html">PowerGrid</a></span><span class="op">(</span>pars <span class="op">=</span> <span class="va">sse_pars</span>, fun <span class="op">=</span> <span class="va">PowFun</span>, n_iter <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">power_array</span><span class="op">)</span> <span class="co"># four dimensions</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Object of class: power_array</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Range of values: [0.03, 1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Evaluated at:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           n 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           n 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           n 58, 60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sig_level 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sig_level 0.09, 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       delta 0.5, 0.7, 0.9, 1.1, 1.3, 1.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          sd 0.1, 0.3, 0.5, 0.7, 0.9</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We can use Example so find the required sample size, but only for one example:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="Example.html">Example</a></span><span class="op">(</span><span class="va">power_array</span>,</span></span>
<span class="r-in"><span>        example <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">.7</span>, sd <span class="op">=</span> <span class="fl">.7</span>, sig_level <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        target_value <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> To achieve the target value of at most 0.9 assuming</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta = 0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd = 0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sig_level = 0.05,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> the minimal required n = 46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Description: Method "step" was used to find the</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lowest n in the searched grid that yields a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> target_value (typically power) of at least 0.9.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## If we want to see the required sample size for all delta's, we can use</span></span></span>
<span class="r-in"><span><span class="co">## FindTarget. Get the minimal n needed for achieving a value of 0.9, at sd =</span></span></span>
<span class="r-in"><span><span class="co">## .3:</span></span></span>
<span class="r-in"><span><span class="va">n_by_delta_sd_03</span> <span class="op">=</span> <span class="fu">FindTarget</span><span class="op">(</span><span class="va">power_array</span><span class="op">[</span>, sig_level <span class="op">=</span> <span class="st">'0.05'</span>, , sd <span class="op">=</span> <span class="st">'0.3'</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                              par_to_search <span class="op">=</span> <span class="st">'n'</span>,</span></span>
<span class="r-in"><span>                              target_value <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n_by_delta_sd_03</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5 0.7 0.9 1.1 1.3 1.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  18  12  10  10  10  10 </span>
<span class="r-in"><span><span class="co">## just as an illustration, a figure (that can be much more aestetically made</span></span></span>
<span class="r-in"><span><span class="co">## using PowerPlot)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">n_by_delta_sd_03</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     <span class="va">n_by_delta_sd_03</span>, type <span class="op">=</span> <span class="st">'l'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FindTarget-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## =================================</span></span></span>
<span class="r-in"><span><span class="co">## Higher dimensionality</span></span></span>
<span class="r-in"><span><span class="co">## =================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The function works also for higher dimensionality:</span></span></span>
<span class="r-in"><span><span class="va">n_by_delta_sd</span> <span class="op">=</span> <span class="fu">FindTarget</span><span class="op">(</span><span class="va">power_array</span>,</span></span>
<span class="r-in"><span>                           par_to_search <span class="op">=</span> <span class="st">'n'</span>,</span></span>
<span class="r-in"><span>                           target_value <span class="op">=</span> <span class="fl">.85</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## what is the minimum n to achieve .85 for different values of delta, sd,</span></span></span>
<span class="r-in"><span><span class="co">## when  sig_level = 0.05:</span></span></span>
<span class="r-in"><span><span class="va">n_by_delta_sd</span><span class="op">[</span><span class="fl">5</span>, , <span class="op">]</span> <span class="co"># note that for some combinations of delta and sd, there is</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta 0.1 0.3 0.5 0.7 0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.5  10  16  38  NA  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.7  10  10  22  38  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.9  10  10  14  24  38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1.1  10  10  10  18  28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1.3  10  10  10  14  20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1.5  10  10  10  12  16</span>
<span class="r-in"><span>                     <span class="co"># no n yielding the required power at this significance</span></span></span>
<span class="r-in"><span>                     <span class="co"># level (NAs).</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gilles Dutilh, Richard Charles Allen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

